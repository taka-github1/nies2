import{s as $,ad as F,j as w,ae as b,af as g,ag as N,ah as j,ai as D,aj as U,ak as I,al as h,am as d,an as R,ao as k}from"./index-6a6230c9.js";import{c as v,a as S}from"./devEnvironmentUtils-5002a058.js";function q(e,t,a,l){const n=e.name;return n==null?Promise.reject(new $("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):e.styleName&&e.styleName==="Esri2DPointSymbolsStyle"?M(n,t,l):F(e,t,l).then(r=>E(r,n,t,a,k,l))}function A(e,t){return t.items.find(a=>a.name===e)}function E(e,t,a,l,n,r){var f;const m=a&&a.portal!=null?a.portal:w.getDefault(),p={portal:m,url:b(e.baseUrl),origin:"portal-item"},o=A(t,e.data);if(!o){const y=`The symbol name '${t}' could not be found`;return Promise.reject(new $("symbolstyleutils:symbol-name-not-found",y,{symbolName:t}))}let i=g(n(o,l),p),u=((f=o.thumbnail)==null?void 0:f.href)??null;const c=o.thumbnail&&o.thumbnail.imageData;v()&&(i=S(i)??"",u=S(u));const P={portal:m,url:b(N(i)),origin:"portal-item"};return j(i,r).then(y=>{const O=l==="cimRef"?D(y.data):y.data,s=U(O,P);if(s&&I(s)){if(u){const x=g(u,p);s.thumbnail=new h({url:x})}else c&&(s.thumbnail=new h({url:`data:image/png;base64,${c}`}));e.styleUrl?s.styleOrigin=new d({portal:a.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(s.styleOrigin=new d({portal:a.portal,styleName:e.styleName,name:t}))}return s})}function M(e,t,a){const l=R.replaceAll(/\{SymbolName\}/gi,e),n=t.portal!=null?t.portal:w.getDefault();return j(l,a).then(r=>{const m=D(r.data);return U(m,{portal:n,url:b(N(l)),origin:"portal-item"})})}export{E as fetchSymbolFromStyle,A as getStyleItemFromStyle,q as resolveWebStyleSymbol};
